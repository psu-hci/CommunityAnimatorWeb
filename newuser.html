<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <style type="text/css">
      html, body { height: 100%; margin: 0; padding: 0; }
      #map { height: 100%; }
    </style>
  <title>Community Animator</title>
  <meta name="description" content="Community Animator">


<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<link rel="icon" href="favicon.ico" type="image/x-icon">
   <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!--Import materialize.css-->
  <link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/> 
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
</head>

<body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-70177830-1', 'auto');
  ga('send', 'pageview');

</script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  <script type="text/javascript" src="js/materialize.min.js"></script>
  <script type="text/javascript" src="http://www.parsecdn.com/js/parse-latest.js"></script>
  
	<div class="navbar-fixed">
    <nav>
    <div class="nav-wrapper white">
      <a href="index.html" class="brand-logo">&nbsp<img src = "images/logo.jpg"></a>
      <ul id="nav-mobile" class="right hide-on-med-and-down">
        <li><a href="newuser.html">Create Account</a></li>
        <li><a href="login.html">Log In</a></li>
      </ul>
    </div>
  </nav>
  </div>
  
  <div id="main">

    <h1><center>Create Account</center></h1>
	<form>
	<center>
	
	<div class = "row">
		<form class="col s12">
			<div class="input-field col s4"></div>
			<div class="input-field col s4">Username: <input type="text" name="username" id="username"/></div>
	</div>
	<div class = "row">
			<div class="input-field col s4"></div>
			<div class="input-field col s4">
			Password: <input type="password" name="password" id ="password" /></div>
	</div>
	<div class = "row">
		<form class="col s12">
			<div class="input-field col s4"></div>
			<div class="input-field col s4">
			Email: <input type="text" name="email" id = "email"/></div>
	</div>
	<div class = "row">
			<div class="input-field col s4"></div>
			<div class="input-field col s4">
			Gender: <input type="text" name="gender" id = "gender"/></div>
	</div>
	<div class = "row">
		<form class="col s12">
			<div class="input-field col s4"></div>
			<div class="input-field col s4">
			Date of Birth (mm/dd/yyyy):<input type="text" name="datebirth" id = "datebirth"/></div>
	</div>
	<div class = "row">
			<div class="input-field col s4"></div>
			<div class="input-field col s4">
			Occupation: <input type="text" name="occupation" id = "occupation"/></div>
		</form>
	</div>
	
	<div class = "row">
	<div class="input-field col s4"></div>
			<div class="input-field col s4">
	<center>
	Interests (check all that apply)
	<p>
      <input type="checkbox" id="ag" />
      <label for="ag">Agriculture and Food</label>
    </p>
    <p>
      <input type="checkbox" id="arts" />
      <label for="arts">Arts and Culture</label>
    </p>
    <p>
            <input type="checkbox" id="built" />
      <label for="built">Built Environment</label>
    </p>
    <p>
            <input type="checkbox" id="bus" />
      <label for="bus">Business and Economy</label>
    </p>
      <p>
              <input type="checkbox" id="civ" />
      <label for="civ">Civil Engagement</label>
    </p>
	<p>
              <input type="checkbox" id="comm" />
      <label for="comm">Communication</label>
    </p>
	<p>
              <input type="checkbox" id="commev" />
      <label for="commev">Community Events</label>
    </p>
	<p>
              <input type="checkbox" id="commgroup" />
      <label for="commgroup">Community Groups</label>
    </p>
	<p>
              <input type="checkbox" id="commproj" />
      <label for="commproj">Community Projects</label>
    </p>
	<p>
              <input type="checkbox" id="edu" />
      <label for="edu">Education and Learning</label>
    </p>
	<p>
              <input type="checkbox" id="energy" />
      <label for="energy">Energy</label>
    </p>
	<p>
              <input type="checkbox" id="ent" />
      <label for="ent">Entrepeneurship</label>
    </p>
	<p>
              <input type="checkbox" id="health" />
      <label for="health">Health and Wellness</label>
    </p>
	<p>
              <input type="checkbox" id="nature" />
      <label for="nature">Nature, Climate Change</label>
    </p>
	<p>
              <input type="checkbox" id="politics" />
      <label for="politics">Politics</label>
    </p>
		<p>
              <input type="checkbox" id="rec" />
      <label for="rec">Recreation and Leisure</label>
    </p>
		<p>
              <input type="checkbox" id="tech" />
      <label for="tech">Technology</label>
    </p>
		<p>
              <input type="checkbox" id="trans" />
      <label for="trans">Transportation and Parking</label>
    </p>
		<br/>
	<br/>
	<hr/>
	</center>
	</div>
	</div>
	
	

	<i>Click map</i> to select location
	<br/>
	<br/>
	<div id="littlemap"></div>
	
	<center>
	<br/>
	<br/>
	<a class="waves-effect waves-light btn orange" value="Submit" onclick="createUser(document.getElementById('username').value, document.getElementById('password').value, document.getElementById('email').value, document.getElementById('gender').value, document.getElementById('datebirth').value, document.getElementById('occupation').value)">Submit</a>
    <br/><br/><br/>
	</center>
	<br/>
  </div>
  
  <script type="text/javascript">
  
	$('.datepicker').pickadate({
		selectMonths: true, // Creates a dropdown to control month
		selectYears: 100 // Creates a dropdown of 15 years to control year		
	});
	
	var interestList = [];
    Parse.initialize("T4lD84ZeLY7615h43jpGlVTG5cXZyXd8ceSGX29e", "KPVDbWy1zWbJD1WPG4HReba5urgHsPVJgh9wX5D1");
    
	function createUser(username, password, email, gender, datebirth, occupation)
	{
		createInterestList();
		var user = new Parse.User();
		user.set("username", username);
		user.set("password", password);
		user.set("email", email);
		user.set("gender", gender)
		user.set("dateBirth", datebirth);
		user.set("distance", 0);
		user.set("occupation", occupation);
		user.set("chatting", false);
		user.set("image", false);
		user.set("reminder", true);
		user.set("status", true);	
		user.set("view", true);
		user.set("taskList", ["HJQNYCjCVh","V3EMgSnf5n","m5VJwIOHGO"])
		user.set("interestList", interestList);
		user.set("location", new Parse.GeoPoint({latitude: latitude, longitude: longitude}));
		
		sessionStorage.user = username;
		
		user.signUp(null, {
		  success: function(user) {
			Materialize.toast("Account created successfully!", 4000) // 4000 is the duration of the toast
			login(username, password);
			//window.location="login.html";
		  },
		  error: function(user, error) {
			// Show the error message somewhere and let the user try again.
			Materialize.toast("Error: " + error.message, 4000) // 4000 is the duration of the toast
			//alert("Error: " + error.code + " " + error.message);
		  }
		});
	}
	
	
	function login(username, password)
	{
	Parse.User.logIn(username, password, {
	  success: function(user) {
		window.location="main.html";
	  },
	  error: function(user, error) {
		Materialize.toast("Username or password incorrect, please try again", 4000) // 4000 is the duration of the toast
	  }
	});
	}
	
	function createInterestList()
	{
		while (interestList.length) { interestList.pop(); }
		
		if(document.getElementById('ag').checked)
		{
			interestList.push("ZfQBlXqdg8");
		}
		if(document.getElementById('arts').checked)
		{
			interestList.push("YmhEi4uo2m");
		}
		if(document.getElementById('built').checked)
		{
			interestList.push("BnXWg7k1P4");
		}
		if(document.getElementById('bus').checked)
		{
			interestList.push("fa3Nx3F2uW");
		}
		if(document.getElementById('civ').checked)
		{
			interestList.push("eJJEe8k6Js");
		}
		if(document.getElementById('comm').checked)
		{
			interestList.push("UpM7ijuW8p");
		}
		if(document.getElementById('comm').checked)
		{
			interestList.push("UpM7ijuW8p");
		}
		if(document.getElementById('commev').checked)
		{
			interestList.push("DvLdrPN5da");
		}
		if(document.getElementById('commgroup').checked)
		{
			interestList.push("zVT0JZoTZq");
		}
		if(document.getElementById('commproj').checked)
		{
			interestList.push("zVT0JZoTZq");
		}
		if(document.getElementById('edu').checked)
		{
			interestList.push("N29x8Xbz4j");
		}
		if(document.getElementById('energy').checked)
		{
			interestList.push("c36TgxZXkZ");
		}
		if(document.getElementById('ent').checked)
		{
			interestList.push("jK4eMH6xdu");
		}
		if(document.getElementById('health').checked)
		{
			interestList.push("mdqSCiZg2f");
		}
		if(document.getElementById('nature').checked)
		{
			interestList.push("cC4OJ1BIfr");
		}
		if(document.getElementById('politics').checked)
		{
			interestList.push("EW5PZBF614");
		}
		if(document.getElementById('rec').checked)
		{
			interestList.push("2O6bxbvA5N");
		}
		if(document.getElementById('tech').checked)
		{
			interestList.push("qlnPM8vFem");
		}
		if(document.getElementById('trans').checked)
		{
			interestList.push("nDvaQM1G1Q");
		}
		//alert(interestList);
		
	}
		var map;
		var markers = [];
		var latitude;
		var longitude;

		
		
function initMap() {
  map = new google.maps.Map(document.getElementById('littlemap'), {
    center: {lat: 40.799361, lng: -77.862548},
    zoom: 14,
	//mapTypeId: google.maps.MapTypeId.HYBRID
  });
  

    map.addListener('click', function(e) {
    placeMarkerAndPanTo(e.latLng, map);
  });
  
   // This event listener will call addMarker() when the map is clicked.
  map.addListener('click', function(event) {
    addMarker(event.latLng);
  });
  
  // Adds a marker to the map and push to the array.
function addMarker(location) {
  var marker = new google.maps.Marker({
    position: location,
	icon: 'http://maps.google.com/mapfiles/ms/micons/orange-dot.png',
    map: map
  });
  markers.push(marker);
}

// Sets the map on all markers in the array.
function setMapOnAll(map) {
  for (var i = 0; i < markers.length; i++) {
    markers[i].setMap(map);
  }
}

// Removes the markers from the map, but keeps them in the array.
function clearMarkers() {
  setMapOnAll(null);
}

// Shows any markers currently in the array.
function showMarkers() {
  setMapOnAll(map);
}

// Deletes all markers in the array by removing references to them.
function deleteMarkers() {
  clearMarkers();
  markers = [];
}
  
  function placeMarkerAndPanTo(latLng, map) {
  deleteMarkers();
  addMarker(latLng);
  latitude = latLng.lat();	
  longitude = latLng.lng();
  map.panTo(latLng);
}
}
	
  </script>
  
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCCOtpN56Gw40PafvxzDl_mmHQZ8ARyeoA&callback=initMap"
        async defer></script>
</body>

</html>
